%!TEX root = main.tex

%For simplicity, we assume that $\Mm$ contains $\standard$ and $\singletask$ activities only. 
%The proof of Theorem~\ref{thm:st-amass-reach} is technically the most challenging part of this paper. 
%To ease the understanding, we shall prove the configuration reachability problem of $\STK$-dominating $\LMAMASS$ (resp. $\STK$-dominating $\IFAMASS$) is decidable in Section~\ref{sec:reach-lmamass} (resp. Section~\ref{sec:reach-ifamass}) first, then prove the configuration reachability problem of $\STK$-dominating $\AMASS$ is decidable in Section~\ref{sec:reach-amass}.


% Following the same approach as the semantic definition, we address the problem step by step in these three scenarios, i.e., $\LMAMASS$, $\IFAMASS$ and {\AMASS}.
% To tackle the configuration reachability problem for $\STK$-dominating $\AMASS$, we consider three case, i.e., 
% $(A,\STK(A'))\notin\Delta$, $\lmd(A_0)=\singletask$ and $\lmd(A_0)\neq\singletask$. 


%\section{Configuration reachability problem of $\AMASS$}\label{sec-conf-reach}
%
%In this paper, we focus on the configuration reachability problem of $\AMASS$. This problem is fundamental to the formal (static) analysis and verification of the behaviors of Android apps with respect to the multitasking mechanism.  
%
%Let $\Mm =(\act, A_0, \lmd, \aft, \Delta)$ be an  {\AMASS}. Then we define $\RConfs(\Mm)$ as the set of configurations $\rho$ that are reachable from the initial configuration, that is, 
%$(A_0, \aft(A_0)) \xRightarrow[\Mm]{} \rho$. 
%Let $(\Aut_1,\cdots,\Aut_k)$ be an {\NFA} tuple over the alphabet $\act$. We define $\Rel((\Aut_1, \cdots, \Aut_k))$ as $(S_1, \cdots, S_k)$ such that for each $i \in [k]$, $S_i \in \Lang(\Aut_i)$. Moreover, let $\theta = \aname_1\cdots\aname_k$ be an affinity sequence. Then $\confs((\theta, (\Aut_1,\cdots,\Aut_k)))$, \emph{the set of configurations accepted by $(\theta, (\Aut_1,\cdots,\Aut_k))$}, is defined as as the set of configurations $\rho = ((S_1,\aname'_1),\cdots,(S_k,\aname'_k))$  such that $(S_1, \cdots, S_k) \in \Rel((\Aut_1, \cdots, \Aut_k))$, and for each $i \in [k]$, $\aname_i=\aname_i'$.
%%
%% $\confs((\theta, (\Aut_1,\cdots,\Aut_k)))$, \emph{the set of configurations accepted by $(\theta, (\Aut_1,\cdots,\Aut_k))$}, as the set of configurations $\rho = ((S_1,\aname'_1),\cdots,(S_k,\aname'_k))$  such that for each $i \in [k]$, $\aname_i=\aname_i'$ and $S_i \in \Lang(\Aut_i)$. 
%Then \emph{the configuration reachability problem} of {\AMASS} is defined as follows. 
%\begin{quote}
%Given an {\AMASS} $\Mm= (\act, A_0, \lmd, \aft, \Delta)$, an affinity sequence $\theta = \aname_1\cdots\aname_k$, and an {\NFA} tuple $(\Aut_1,\cdots,\Aut_k)$ over the alphabet $\act$, decide whether $ \confs({(\theta, (\Aut_1,\cdots,\Aut_k))}) \cap \RConfs(\Mm) \neq \emptyset$.
%\end{quote}

\section{TBA}




\begin{proposition}\label{prop-stk}
    Let $\Mm=(\act,A_0,\lmd,\aft,\Delta)$ be an $\STK$-dominating $\AMASS$. Then each configuration $\rho$ that is reachable from the initial configuration $(([A_0],\aft(A_0)))$ in $\Mm$ satisfies the following constraints:
    \begin{enumerate}
        \item for each $\STK$-activity $A\in\act$ with $\aft(A)\neq\aft(A_0)$, $A$ can only occur at the bottom of some task in $\rho$, 
        \item $\rho$ contains at most one $\standard/\singletop$-task, which, when it exists, has the same affinity as $A_0$.
		% \item $\SIT$ activity has the same effects with $\STK$ activity.
    \end{enumerate}
\end{proposition}



%The rest of this paper is devoted to the proof of Theorem~\ref{thm:st-amass-reach}. 

%Since the decision procedure is involved, to ease the understanding, we present the decision procedure for $\singletask$-dominating $\LMAMASS$ first (Section~\ref{sec:reach-lmamass}), then $\singletask$-dominating $\IFAMASS$ (Section~\ref{sec:reach-ifamass}), and finally consider $\singletask$-dominating $\AMASS$ in its most general case (Section~\ref{sec:reach-amass}). 

For technical convenience, we assume that 
\begin{itemize}
	\item \emph{the affinities of $\singleinstance$-activities are mutually distinct, moreover, they are different from those of the other activities}, that is, for each $A, B \in \act_\singleinstance$ with $A \neq B$, we have $\aft(A) \neq \aft(B)$, moreover, $\aft(\act_\singleinstance) \cap \aft(\act \setminus \act_\singleinstance) = \emptyset$.
\end{itemize} Note that this assumption is not a restriction, since regarding the task allocation mechanism, the affinities of $\singleinstance$-activities are redundant and independent of those of the other activities. With this assumption, the task allocation mechanism (formalized by $\gettsk(\rho, B)$) can be specified by the \emph{name function} $\namefun_B(\theta)$ defined in the sequel:  Let $\theta = \aname_1 \cdots \aname_k$ and $B \in \act$. Then $\namefun_B(\theta) = i$ if $\aft(B) = \aname_i$ for some $i \in [k]$, and $\namefun_B(\theta) = \bot$ otherwise. Note that the invariant of configurations, that is, the task affinities of every two non-$\singleinstance$ tasks are mutually distinct, guarantees the well-definedness of $\namefun_B(\theta)$.

%For simplicity, we assume that $\Mm$ contains $\standard$ and $\singletask$ activities only. 
%The proof of Theorem~\ref{thm:st-amass-reach} is technically the most challenging part of this paper. 
%To ease the understanding, we shall prove the configuration reachability problem of $\STK$-dominating $\LMAMASS$ (resp. $\STK$-dominating $\IFAMASS$) is decidable in Section~\ref{sec:reach-lmamass} (resp. Section~\ref{sec:reach-ifamass}) first, then prove the configuration reachability problem of $\STK$-dominating $\AMASS$ is decidable in Section~\ref{sec:reach-amass}.



\section{Configuration reachability problem of $\STK$-dominating $\LMAMASS$}\label{sec:reach-lmamass}
\input{reach-lmamass.tex}

\section{Configuration reachability problem of $\STK$-dominating $\IFAMASS$}\label{sec:reach-ifamass}
\input{reach-ifamass.tex}
% \subsection{Complete case}\label{sec:complete-case}


\section{Configuration reachability problem of $\STK$-dominating $\AMASS$}\label{sec:reach-amass}

We are ready to state the main result of this paper. 

\begin{theorem}\label{thm:st-amass-reach}
	The configuration reachability problem of $\STK$-dominating $\AMASS$ is decidable.
\end{theorem}

\input{reach-amass.tex}